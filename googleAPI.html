<html lang="en">
    <head>
        <title>Simple Weather App</title>
        <link rel="stylesheet" href="css/weatherApp.css">
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    </head>
    <body>
        <div id="forecast">
            <h1>The weather in <span id="location">THIS PLACE</span></h1>
            <p>is currently <span id="temp">9000</span> F with <span id="desc">stuff</span></p>
            <p>Wind: <span id="wind"></span></p>
            <h2>Weather Search: </h2>
            State (KS) <input type="text" id="state"  size="2" maxlength="2"/></br>
            City (Olathe) <input type="text" id="city"/>
            <span id="button" onclick="getWeather();">Click Here</span>
        </div>
    </body>
    <script>
       var Geo={};
            if(navigator.geolocation){
                navigator.geolocation.getCurrentPosition(success,error);
            } else {
                alert ("Geolocation is not supported");
            }
            
            function error(){
                alert("We couldn't find you!");
            }
            
            function success(position){
                Geo.lat = position.coords.latitude;
                Geo.lng = position.coords.longitude;
                getWeather();
            }
            
            function getWeather(){
                
                var key = "c043d4759e8caed9";
                if ($(state).val() && $(city).val()){
                    var Weather = "http://api.wunderground.com/api/" + key + "/forecast/geolookup/conditions/q/" + $(state).val() + "/" + $(city).val() + ".json";
                }else if(Geo.lat && Geo.lng){
                    var Weather = "http://api.wunderground.com/api/" + key + "/forecast/geolookup/conditions/q/" + Geo.lat + "," + Geo.lng + ".json";    
                } else {
                    alert ("Please enable your location or select a valid state and city.")
                }
                
                
                
                $.ajax({
                    url : Weather,
                    dataType : "jsonp",
                    success : function(data){
                        console.log(data);
                        var location = data['location']['city'];
                        var temp = data['current_observation']['temp_f'];
                        var img = data['current_observation']['icon_url'];
                        var desc = data['current_observation']['weather'];
                        var wind = data['current_observation']['wind_string'];
                        
                        $('#location').html(location);
                        $('#temp').html(temp);
                        $('#desc').html(desc);
                        $('#wind').html(wind);
                    }
                });
                
            }
    </script>
</html>